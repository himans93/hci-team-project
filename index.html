<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Chore Board Prototype â€“ Rooms & Roles</title>
  <style>
    :root {
      --bg-board: #f5f8fb;
      --bg-card: #ffffff;
      --bg-person: #f3f7fb;
      --accent-blue: #4fb5ff;
      --accent-orange: #ff9757;
      --accent-teal: #5fd3c4;
      --accent-pink: #ff7aa8;
      --late-text: #ff6a6a;
      --text-main: #1c2936;
      --text-muted: #7c8a9c;
      --border-soft: #e0e6f0;
      --shadow-soft: 0 18px 40px rgba(39, 79, 117, 0.18);
      --radius-lg: 24px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #e0f2ff, #f8f9ff);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      color: var(--text-main);
    }

    .board {
      width: 1000px;
      max-width: 95vw;
      background: var(--bg-board);
      border-radius: 40px;
      box-shadow: var(--shadow-soft);
      padding: 24px 32px 32px;
      position: relative;
      overflow: hidden;
      transition: background 0.25s ease, transform 0.25s ease;
    }

    .board.celebrate {
      animation: board-flash 0.8s ease-out;
    }

    @keyframes board-flash {
      0% {
        background: var(--bg-board);
        transform: scale(1);
      }
      25% {
        background: #fff7e0;
        transform: scale(1.01);
      }
      55% {
        background: #f2ffeb;
      }
      100% {
        background: var(--bg-board);
        transform: scale(1);
      }
    }

    .board-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      font-size: 14px;
      color: var(--text-muted);
    }

    .hide-completed {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      user-select: none;
    }

    .hide-completed input {
      accent-color: var(--accent-blue);
      width: 14px;
      height: 14px;
      cursor: pointer;
    }

    .date-nav {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .date-label {
      font-weight: 500;
      color: var(--text-main);
    }

    .nav-btn {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background: var(--bg-card);
      font-size: 16px;
      line-height: 1;
      user-select: none;
    }

    /* Room tabs + add-room button */

    .rooms-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 18px;
    }

    .room-tabs {
      display: inline-flex;
      gap: 8px;
      background: rgba(255,255,255,0.6);
      padding: 4px;
      border-radius: 999px;
    }

    .room-tab {
      border-radius: 999px;
      border: 1px solid transparent;
      background: transparent;
      padding: 6px 14px;
      font-size: 13px;
      color: var(--text-muted);
      cursor: pointer;
      transition: background 0.15s ease, box-shadow 0.15s ease,
                  color 0.15s ease, border-color 0.15s ease;
    }

    .room-tab.active {
      background: #ffffff;
      color: var(--text-main);
      border-color: var(--border-soft);
      box-shadow: 0 6px 16px rgba(39, 79, 117, 0.18);
    }

    .add-room-btn {
      border-radius: 999px;
      border: 1px dashed var(--accent-blue);
      background: rgba(79,181,255,0.07);
      padding: 6px 14px;
      font-size: 12px;
      color: var(--accent-blue);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .add-room-btn span.icon {
      font-size: 14px;
    }

    .room-panel {
      display: none;
    }

    .room-panel.active {
      display: block;
    }

    .people-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 24px;
    }

    @media (max-width: 800px) {
      .people-grid {
        grid-template-columns: 1fr;
      }
    }

    .person-card {
      background: var(--bg-person);
      border-radius: var(--radius-lg);
      padding: 18px 18px 14px;
      position: relative;
      overflow: hidden;
    }

    .person-header {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }

    .avatar {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 18px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .avatar.dad     { background: var(--accent-blue); }
    .avatar.mom     { background: var(--accent-orange); }
    .avatar.brother { background: var(--accent-teal); }
    .avatar.grandma { background: var(--accent-pink); }

    .person-name {
      font-weight: 600;
      font-size: 17px;
      margin-bottom: 2px;
    }

    .person-progress {
      font-size: 12px;
      color: var(--text-muted);
    }

    .task-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 6px;
    }

    .task-card {
      background: var(--bg-card);
      border-radius: 18px;
      padding: 10px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      font-size: 13px;
      border: 1px solid transparent;
      transition: border 0.15s ease, opacity 0.15s ease, transform 0.12s ease;
    }

    .task-card:hover {
      border-color: var(--border-soft);
      transform: translateY(-1px);
    }

    .task-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .task-title {
      font-weight: 500;
    }

    .task-meta {
      font-size: 11px;
      color: var(--late-text);
    }

    .task-meta.weekly {
      color: var(--text-muted);
    }

    .task-card.celebrate-pulse {
      animation: card-pulse 0.5s ease-out;
      border-color: #7ed47b;
    }

    @keyframes card-pulse {
      0% {
        transform: scale(1);
        box-shadow: 0 0 0 rgba(126, 212, 123, 0);
      }
      40% {
        transform: scale(1.03);
        box-shadow: 0 0 0 8px rgba(126, 212, 123, 0.4);
      }
      100% {
        transform: scale(1);
        box-shadow: 0 0 0 rgba(126, 212, 123, 0);
      }
    }

    /* NEW: checkmark instead of slider */

    .task-toggle {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid #ff6a6a;          /* red border when not done */
      background: #ffe5e5;                /* light red background */
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      flex-shrink: 0;
      transition: background 0.18s ease, border-color 0.18s ease;
    }

    .task-toggle.on {
      background: #7ed47b;               /* green when done */
      border-color: #7ed47b;
    }

    .task-toggle input {
      display: none;
    }

    .task-toggle-pill {
      font-size: 14px;
      color: #ffffff;
      opacity: 0;
      transition: opacity 0.18s ease;
      pointer-events: none;
    }

    .task-toggle input:checked + .task-toggle-pill {
      opacity: 1;                        /* show âœ“ when checked */
    }

    .task-card.completed {
      opacity: 0.55;
    }

    .task-card.completed .task-title {
      text-decoration: line-through;
    }

    /* Celebration confetti */

    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: visible;
      z-index: 999;
    }

    .confetti-piece {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      opacity: 0;
      animation: confetti-pop 0.9s ease-out forwards;
    }

    @keyframes confetti-pop {
      0% {
        transform: translate(0,0) scale(0.4) rotate(0deg);
        opacity: 0;
      }
      20% {
        opacity: 1;
      }
      100% {
        transform: translate(var(--confetti-translateX), var(--confetti-translateY))
                   scale(1) rotate(var(--confetti-rotation));
        opacity: 0;
      }
    }

    /* Toast */

    .toast {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(24, 30, 42, 0.98);
      color: #ffffff;
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 10px 25px rgba(33, 60, 102, 0.45);
      opacity: 0;
      animation: toast-pop 1.4s ease-out forwards;
      pointer-events: none;
      z-index: 1000;
    }

    @keyframes toast-pop {
      0% {
        opacity: 0;
        transform: translate(-50%, -8px) scale(0.9);
      }
      20% {
        opacity: 1;
        transform: translate(-50%, 0) scale(1);
      }
      70% {
        opacity: 1;
        transform: translate(-50%, 0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(-50%, -6px) scale(0.96);
      }
    }

    /* Template modal */

    .template-overlay {
      position: fixed;
      inset: 0;
      background: rgba(5, 16, 41, 0.35);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 900;
    }

    .template-overlay.open {
      display: flex;
    }

    .template-modal {
      background: #ffffff;
      border-radius: 20px;
      padding: 18px 20px 16px;
      width: 340px;
      max-width: 90vw;
      box-shadow: 0 16px 40px rgba(21, 48, 94, 0.4);
      font-size: 13px;
    }

    .template-modal h2 {
      font-size: 16px;
      margin-bottom: 8px;
    }

    .template-modal p {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 10px;
    }

    .template-section {
      margin-bottom: 10px;
    }

    .template-section label {
      display: block;
      margin-bottom: 4px;
      font-weight: 500;
    }

    .template-modal select,
    .template-modal input[type="text"] {
      width: 100%;
      padding: 6px 8px;
      border-radius: 10px;
      border: 1px solid var(--border-soft);
      font-size: 13px;
    }

    .role-checkboxes {
      display: flex;
      flex-wrap: wrap;
      gap: 6px 14px;
      font-size: 12px;
    }

    .role-checkboxes label {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
    }

    .template-actions {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 6px;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
    }

    .btn-secondary {
      background: #eef1f7;
      color: var(--text-main);
    }

    .btn-primary {
      background: var(--accent-blue);
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="board">
    <header class="board-header">
      <label class="hide-completed">
        <input type="checkbox" id="hideCompleted" />
        <span>Hide completed</span>
      </label>
      <div class="date-nav">
        <div class="nav-btn" aria-label="Previous day">&#8249;</div>
        <span class="date-label">Today</span>
        <div class="nav-btn" aria-label="Next day">&#8250;</div>
      </div>
    </header>

    <!-- tabs + add-room -->
    <div class="rooms-bar">
      <div class="room-tabs" role="tablist" id="roomTabs">
        <button class="room-tab active" data-room="living">Living Room</button>
        <button class="room-tab" data-room="kitchen">Kitchen</button>
        <button class="room-tab" data-room="patio">Patio</button>
      </div>
      <button class="add-room-btn" id="addRoomBtn">
        <span class="icon">ï¼‹</span><span>New room from template</span>
      </button>
    </div>

    <!-- LIVING ROOM -->
    <section class="room-panel active" data-room="living">
      <div class="people-grid">
        <!-- Dad -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar dad" aria-hidden="true">ðŸ‘¨</div>
            <div>
              <div class="person-name">Dad</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Vacuum living room</span>
                <span class="task-meta weekly">Weekly Â· Sunday</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card late">
              <div class="task-main">
                <span class="task-title">Dust TV console</span>
                <span class="task-meta">Overdue Â· 2 days</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>

        <!-- Mom -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar mom" aria-hidden="true">ðŸ‘©</div>
            <div>
              <div class="person-name">Mom</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card late">
              <div class="task-main">
                <span class="task-title">Declutter coffee table</span>
                <span class="task-meta">Overdue Â· 1 day</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Fold blankets & throws</span>
                <span class="task-meta weekly">Every evening</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>

        <!-- Brother -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar brother" aria-hidden="true">ðŸ§‘</div>
            <div>
              <div class="person-name">Brother</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Collect cups & snack bowls</span>
                <span class="task-meta weekly">Nightly</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Tidy game controllers</span>
                <span class="task-meta weekly">After gaming session</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>

        <!-- Grandma -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar grandma" aria-hidden="true">ðŸ‘µ</div>
            <div>
              <div class="person-name">Grandma</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Water living room plants</span>
                <span class="task-meta weekly">Twice a week</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card late">
              <div class="task-main">
                <span class="task-title">Arrange cushions on sofa</span>
                <span class="task-meta">Overdue Â· 1 day</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>
      </div>
    </section>

    <!-- KITCHEN -->
    <section class="room-panel" data-room="kitchen">
      <div class="people-grid">
        <!-- Dad -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar dad" aria-hidden="true">ðŸ‘¨</div>
            <div>
              <div class="person-name">Dad</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card late">
              <div class="task-main">
                <span class="task-title">Take out trash & recycling</span>
                <span class="task-meta">Overdue Â· 1 day</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Mop kitchen floor</span>
                <span class="task-meta weekly">Every Saturday</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>

        <!-- Mom -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar mom" aria-hidden="true">ðŸ‘©</div>
            <div>
              <div class="person-name">Mom</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Cook dinner</span>
                <span class="task-meta weekly">Today Â· 7 pm</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Load dishwasher</span>
                <span class="task-meta weekly">After dinner</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>

        <!-- Brother -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar brother" aria-hidden="true">ðŸ§‘</div>
            <div>
              <div class="person-name">Brother</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Clear dining table</span>
                <span class="task-meta weekly">Nightly</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Wipe kitchen counters</span>
                <span class="task-meta weekly">After meals</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>

        <!-- Grandma -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar grandma" aria-hidden="true">ðŸ‘µ</div>
            <div>
              <div class="person-name">Grandma</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Dry dishes</span>
                <span class="task-meta weekly">After dinner</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card late">
              <div class="task-main">
                <span class="task-title">Organize pantry shelf</span>
                <span class="task-meta">Overdue Â· 3 days</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>
      </div>
    </section>

    <!-- PATIO -->
    <section class="room-panel" data-room="patio">
      <div class="people-grid">
        <!-- Dad -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar dad" aria-hidden="true">ðŸ‘¨</div>
            <div>
              <div class="person-name">Dad</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Sweep patio</span>
                <span class="task-meta weekly">Weekly Â· Saturday</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Clean grill</span>
                <span class="task-meta weekly">After BBQ</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>

        <!-- Mom -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar mom" aria-hidden="true">ðŸ‘©</div>
            <div>
              <div class="person-name">Mom</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Shake out doormat</span>
                <span class="task-meta weekly">Every weekend</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Water outdoor plants</span>
                <span class="task-meta weekly">3Ã— per week</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>

        <!-- Brother -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar brother" aria-hidden="true">ðŸ§‘</div>
            <div>
              <div class="person-name">Brother</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">1</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Put away sports gear</span>
                <span class="task-meta weekly">After practice</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>

        <!-- Grandma -->
        <article class="person-card">
          <div class="person-header">
            <div class="avatar grandma" aria-hidden="true">ðŸ‘µ</div>
            <div>
              <div class="person-name">Grandma</div>
              <div class="person-progress">
                <span class="completed-count">0</span>/<span class="total-count">2</span> tasks
              </div>
            </div>
          </div>
          <div class="task-list">
            <div class="task-card">
              <div class="task-main">
                <span class="task-title">Wipe patio table & chairs</span>
                <span class="task-meta weekly">Before guests arrive</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
            <div class="task-card late">
              <div class="task-main">
                <span class="task-title">Fold outdoor blankets</span>
                <span class="task-meta">Overdue Â· 1 day</span>
              </div>
              <label class="task-toggle">
                <input type="checkbox" />
                <span class="task-toggle-pill">âœ“</span>
              </label>
            </div>
          </div>
        </article>
      </div>
    </section>
  </div>

  <!-- Template modal -->
  <div class="template-overlay" id="templateOverlay">
    <div class="template-modal">
      <h2>New room from template</h2>
      <p>Select a room template and who shares that room. Weâ€™ll pre-fill some example chores.</p>

      <div class="template-section">
        <label for="templateSelect">Room template</label>
        <select id="templateSelect"></select>
      </div>

      <div class="template-section">
        <label for="roomNameInput">Room name (optional)</label>
        <input type="text" id="roomNameInput" placeholder="e.g., Kids' Bedroom" />
      </div>

      <div class="template-section">
        <label>Who does chores in this room?</label>
        <div class="role-checkboxes" id="roleCheckboxes">
          <label><input type="checkbox" value="Dad" checked /> Dad</label>
          <label><input type="checkbox" value="Mom" checked /> Mom</label>
          <label><input type="checkbox" value="Brother" checked /> Brother</label>
          <label><input type="checkbox" value="Grandma" /> Grandma</label>
        </div>
      </div>

      <div class="template-actions">
        <button class="btn btn-secondary" id="cancelTemplateBtn">Cancel</button>
        <button class="btn btn-primary" id="createRoomBtn">Create room</button>
      </div>
    </div>
  </div>

  <script>
    // --- DATA: role config & room templates --------------------

    const ROLE_CONFIG = {
      Dad:    { avatarClass: "dad",    icon: "ðŸ‘¨" },
      Mom:    { avatarClass: "mom",    icon: "ðŸ‘©" },
      Brother:{ avatarClass: "brother",icon: "ðŸ§‘" },
      Grandma:{ avatarClass: "grandma",icon: "ðŸ‘µ" }
    };

    const ROOM_TEMPLATES = {
      "Shared Bedroom": {
        defaultName: "Shared Bedroom",
        chores: {
          Dad: [
            { title: "Fix loose bed slats", meta: "Monthly", metaClass: "weekly" },
            { title: "Rotate mattresses", meta: "Every 3 months", metaClass: "weekly" }
          ],
          Mom: [
            { title: "Sort outgrown clothes", meta: "Seasonal", metaClass: "weekly" },
            { title: "Wash bed sheets", meta: "Weekly Â· Saturday", metaClass: "weekly" }
          ],
          Brother: [
            { title: "Put toys back in bins", meta: "Nightly", metaClass: "weekly" },
            { title: "Clear desk before bed", meta: "Every evening", metaClass: "weekly" }
          ],
          Grandma: [
            { title: "Air out blankets", meta: "Weekly", metaClass: "weekly" }
          ]
        }
      },
      "Guest Bathroom": {
        defaultName: "Guest Bathroom",
        chores: {
          Dad: [
            { title: "Check towels & soap", meta: "Before guests arrive", metaClass: "weekly" }
          ],
          Mom: [
            { title: "Wipe sink & mirror", meta: "Every 2 days", metaClass: "weekly" },
            { title: "Refill toiletries basket", meta: "Weekly", metaClass: "weekly" }
          ],
          Brother: [
            { title: "Empty bathroom trash", meta: "Twice a week", metaClass: "weekly" }
          ],
          Grandma: [
            { title: "Fold spare towels", meta: "Monthly", metaClass: "weekly" }
          ]
        }
      },
      "Homework Corner": {
        defaultName: "Homework Corner",
        chores: {
          Dad: [
            { title: "Check chargers & cables", meta: "Weekly Â· Sunday", metaClass: "weekly" }
          ],
          Mom: [
            { title: "Review school papers pile", meta: "Every Friday", metaClass: "weekly" }
          ],
          Brother: [
            { title: "Clear homework desk", meta: "After homework", metaClass: "weekly" },
            { title: "Return pens & markers", meta: "Nightly", metaClass: "weekly" }
          ]
        }
      }
    };

    // --- progress & hide-completed -----------------------------

    function updateProgress(personCard) {
      const tasks = personCard.querySelectorAll(".task-card");
      const completed = personCard.querySelectorAll(".task-card.completed").length;
      const completedSpan = personCard.querySelector(".completed-count");
      const totalSpan = personCard.querySelector(".total-count");
      if (completedSpan && totalSpan) {
        completedSpan.textContent = completed;
        totalSpan.textContent = tasks.length;
      }
    }

    function applyHideCompleted() {
      const hide = document.getElementById("hideCompleted").checked;
      document.querySelectorAll(".task-card.completed").forEach(card => {
        card.style.display = hide ? "none" : "";
      });
    }

    // --- toast & confetti --------------------------------------

    function showToast(message) {
      const board = document.querySelector(".board");
      const existing = board.querySelector(".toast");
      if (existing) existing.remove();

      const toast = document.createElement("div");
      toast.className = "toast";
      toast.innerHTML = `<span>ðŸŽ‰</span><span>${message}</span>`;
      board.appendChild(toast);

      setTimeout(() => {
        toast.remove();
      }, 1400);
    }

    function triggerCelebration(taskCard) {
      const colors = ["#4fb5ff", "#ff9757", "#5fd3c4", "#ff7aa8", "#ffd76f"];
      let container = document.getElementById("confetti-container");
      if (!container) {
        container = document.createElement("div");
        container.id = "confetti-container";
        container.className = "confetti-container";
        document.body.appendChild(container);
      }

      const rect = taskCard.getBoundingClientRect();
      const originX = rect.left + rect.width / 2;
      const originY = rect.top + rect.height / 2;

      for (let i = 0; i < 40; i++) {
        const piece = document.createElement("span");
        piece.className = "confetti-piece";
        const dx = (Math.random() - 0.5) * 220;
        const dy = - (Math.random() * 140 + 40);
        const rot = Math.random() * 360 + "deg";

        piece.style.left = originX + "px";
        piece.style.top = originY + "px";
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        piece.style.setProperty("--confetti-translateX", dx + "px");
        piece.style.setProperty("--confetti-translateY", dy + "px");
        piece.style.setProperty("--confetti-rotation", rot);

        container.appendChild(piece);
        setTimeout(() => piece.remove(), 950);
      }

      const board = document.querySelector(".board");
      board.classList.add("celebrate");
      setTimeout(() => board.classList.remove("celebrate"), 850);

      taskCard.classList.add("celebrate-pulse");
      setTimeout(() => taskCard.classList.remove("celebrate-pulse"), 550);

      showToast("Chore completed!");
    }

    // --- task toggle wiring (reusable for dynamically added) ---

    function attachToggleHandler(input) {
      if (input.dataset.bound === "1") return;
      input.dataset.bound = "1";

      input.addEventListener("change", e => {
        const taskCard = e.target.closest(".task-card");
        if (!taskCard) return;

        const isCompleted = e.target.checked;
        taskCard.classList.toggle("completed", isCompleted);

        const toggle = e.target.closest(".task-toggle");
        if (toggle) {
          toggle.classList.toggle("on", isCompleted);
        }

        const personCard = taskCard.closest(".person-card");
        if (personCard) updateProgress(personCard);

        if (isCompleted) {
          triggerCelebration(taskCard);
        }

        applyHideCompleted();
      });
    }

    function wireAllToggles() {
      document.querySelectorAll(".task-toggle input").forEach(attachToggleHandler);
    }

    // --- room tabs (event delegation) --------------------------

    document.getElementById("roomTabs").addEventListener("click", e => {
      const tab = e.target.closest(".room-tab");
      if (!tab) return;
      const room = tab.dataset.room;

      document.querySelectorAll(".room-tab").forEach(t =>
        t.classList.toggle("active", t === tab)
      );
      document.querySelectorAll(".room-panel").forEach(panel =>
        panel.classList.toggle("active", panel.dataset.room === room)
      );
    });

    // --- hide-completed listener -------------------------------

    document.getElementById("hideCompleted").addEventListener("change", applyHideCompleted);

    // --- template modal logic ----------------------------------

    const overlay = document.getElementById("templateOverlay");
    const addRoomBtn = document.getElementById("addRoomBtn");
    const templateSelect = document.getElementById("templateSelect");
    const roomNameInput = document.getElementById("roomNameInput");
    const createRoomBtn = document.getElementById("createRoomBtn");
    const cancelTemplateBtn = document.getElementById("cancelTemplateBtn");

    Object.keys(ROOM_TEMPLATES).forEach(name => {
      const opt = document.createElement("option");
      opt.value = name;
      opt.textContent = name;
      templateSelect.appendChild(opt);
    });

    function openTemplateModal() {
      const firstTemplate = ROOM_TEMPLATES[templateSelect.value] || ROOM_TEMPLATES[Object.keys(ROOM_TEMPLATES)[0]];
      roomNameInput.value = firstTemplate ? firstTemplate.defaultName : "";
      overlay.classList.add("open");
    }

    addRoomBtn.addEventListener("click", openTemplateModal);

    cancelTemplateBtn.addEventListener("click", () => {
      overlay.classList.remove("open");
    });

    overlay.addEventListener("click", e => {
      if (e.target === overlay) overlay.classList.remove("open");
    });

    templateSelect.addEventListener("change", () => {
      const tmpl = ROOM_TEMPLATES[templateSelect.value];
      if (tmpl && !roomNameInput.value) {
        roomNameInput.value = tmpl.defaultName;
      }
    });

    function createTaskListHTML(chores) {
      return chores.map(chore => {
        const cardClass = "task-card" + (chore.late ? " late" : "");
        const metaClass = chore.metaClass === "weekly" ? "task-meta weekly" : "task-meta";
        return `
          <div class="${cardClass}">
            <div class="task-main">
              <span class="task-title">${chore.title}</span>
              <span class="${metaClass}">${chore.meta}</span>
            </div>
            <label class="task-toggle">
              <input type="checkbox" />
              <span class="task-toggle-pill">âœ“</span>
            </label>
          </div>`;
      }).join("");
    }

    function createPersonCard(roleName, chores) {
      const config = ROLE_CONFIG[roleName];
      if (!config) return null;

      const article = document.createElement("article");
      article.className = "person-card";
      const tasksHTML = createTaskListHTML(chores);

      article.innerHTML = `
        <div class="person-header">
          <div class="avatar ${config.avatarClass}" aria-hidden="true">${config.icon}</div>
          <div>
            <div class="person-name">${roleName}</div>
            <div class="person-progress">
              <span class="completed-count">0</span>/<span class="total-count">${chores.length}</span> tasks
            </div>
          </div>
        </div>
        <div class="task-list">
          ${tasksHTML}
        </div>
      `;
      return article;
    }

    function createRoomFromTemplate() {
      const templateName = templateSelect.value;
      const tmpl = ROOM_TEMPLATES[templateName];
      if (!tmpl) return;

      const chosenName = roomNameInput.value.trim() || tmpl.defaultName;
      const slugBase = chosenName.toLowerCase().replace(/[^a-z0-9]+/g, "-");
      const slug = slugBase + "-" + Date.now().toString(36);

      const roles = Array.from(document.querySelectorAll("#roleCheckboxes input:checked"))
        .map(cb => cb.value);

      if (roles.length === 0) {
        alert("Select at least one family member for this room.");
        return;
      }

      const tab = document.createElement("button");
      tab.className = "room-tab";
      tab.dataset.room = slug;
      tab.textContent = chosenName;
      document.getElementById("roomTabs").appendChild(tab);

      const panel = document.createElement("section");
      panel.className = "room-panel";
      panel.dataset.room = slug;

      const grid = document.createElement("div");
      grid.className = "people-grid";

      roles.forEach(roleName => {
        const chores = (tmpl.chores[roleName] || [
          { title: "Example chore for " + roleName, meta: "Weekly", metaClass: "weekly" }
        ]);
        const card = createPersonCard(roleName, chores);
        if (card) grid.appendChild(card);
      });

      panel.appendChild(grid);
      document.querySelector(".board").appendChild(panel);

      document.querySelectorAll(".room-tab").forEach(t =>
        t.classList.toggle("active", t === tab)
      );
      document.querySelectorAll(".room-panel").forEach(p =>
        p.classList.toggle("active", p.dataset.room === slug)
      );

      wireAllToggles();
      panel.querySelectorAll(".person-card").forEach(updateProgress);

      overlay.classList.remove("open");
    }

    createRoomBtn.addEventListener("click", createRoomFromTemplate);

    // --- initial wiring ----------------------------------------

    wireAllToggles();
    document.querySelectorAll(".person-card").forEach(updateProgress);
  </script>
</body>
</html>
